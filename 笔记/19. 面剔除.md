#  面剔除

- 为什么需要面剔除

  3D立方体，从观察者角度去看我们最多能看到3的平面，而看不到的面我们仍然需要资源去渲染。如何剔除这些看不见的面来提高效率？-------面剔除

- 面剔除工作原理

  在了解工作原理之前，我们先了解一下顶点的定义顺序

  ![img](C:\Users\曾伟\Desktop\typora笔记\计算机图形学笔记\笔记\assets\faceculling_windingorder.png)

  ```c++
  float vertices[] = {
      // 顺时针
      vertices[0], // 顶点1
      vertices[1], // 顶点2
      vertices[2], // 顶点3
      // 逆时针
      vertices[0], // 顶点1
      vertices[2], // 顶点3
      vertices[1]  // 顶点2  
  };
  //三个顶点自带环绕顺序（实际的环绕顺序是在光栅化阶段进行的）。逆序定义的三角形为正三角形，顺序定义的为背向三角形
  ```

  接下来我们分析以下原理：先上图

  ![img](C:\Users\曾伟\Desktop\typora笔记\计算机图形学笔记\笔记\assets\faceculling_frontback.png)

  ```html
  前言：
  - 对于背面三角形的观察角度有两个：1.观察者视角 2.（相对于正向面而言而非观察者视角）背面的正视角（把眼睛移到背面正对着背面看）我们简称正视角
  - 在定义三角形环绕顺序时我们是根据正面或者背面的正视角进行定义的。
  ```

  然后可以看懂官方文档描述了

  ```html
  在顶点数据中，我们将两个三角形都以逆时针顺序定义（正面的三角形是1、2、3，背面的三角形也是1、2、3（如果我们从正面看这个三角形的话））。然而，如果从观察者当前视角使用1、2、3的顺序来绘制的话，从观察者的方向来看，背面的三角形将会是以顺时针顺序渲染的。虽然背面的三角形是以逆时针定义的，它现在是以顺时针顺序渲染的了。这正是我们想要剔除（Cull，丢弃）的不可见面了！
  
  在顶点数据中，我们定义的是两个逆时针顺序的三角形。然而，从观察者的方面看，后面的三角形是顺时针的，如果我们仍以1、2、3的顺序以观察者当面的视野看的话。即使我们以逆时针顺序定义后面的三角形，它现在还是变为顺时针。它正是我们打算剔除（丢弃）的不可见的面！
  ```

- 面剔除流程

  1. 打开开关

     ```c++
     glEnable(GL_CULL_FACE);
     ```

  就一步....

- 面剔除操作函数

  1. 改变剔除面的类型（正面or背面or都剔除）

     ```c++
     glCullFace(GL_FRONT);
     //GL_BACK:剔除背面（相对于正向面）
     //GL_FRONT:剔除正面（相对于正向面）
     //GL_FRONT_AND_BACK：剔除正面和背面
     ```

  2. 指定某环绕顺序为正向面

     ```c++
     glFrontFace(GL_CCW);
     //GL_CCW:指定逆时针的环绕顺序的面为正向面
     //GL_CW：指定顺时针的环绕顺序的面为正向面
     ```

  验证实验：我们可以来做一个实验，告诉OpenGL现在顺时针顺序代表的是正向面：

  ```c++
  glEnable(GL_CULL_FACE);
  glCullFace(GL_BACK);
  glFrontFace(GL_CW);
  ```

  实验效果

  ![img](C:\Users\曾伟\Desktop\typora笔记\计算机图形学笔记\笔记\assets\faceculling_reverse.png)

  ```c++
  这样的结果是只有背向面被渲染了
  ```

- 

